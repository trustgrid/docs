<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>– Edge Node Startup</title><link>https://docs.trustgrid.io/help-center/kb/startup-process/</link><description>Recent content in Edge Node Startup on</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://docs.trustgrid.io/help-center/kb/startup-process/index.xml" rel="self" type="application/rss+xml"/><item><title>Help-Center: Configuration Update Failure Troubleshooting</title><link>https://docs.trustgrid.io/help-center/kb/startup-process/config-update-failure/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/help-center/kb/startup-process/config-update-failure/</guid><description>
&lt;h2 id="symptoms">Symptoms&lt;/h2>
&lt;ul>
&lt;li>Changes made via the portal or api are not implemented on the actual node&lt;/li>
&lt;li>In versions after 20240719, the &lt;code>Configuration Update Failure&lt;/code> event will be sent by appliance nodes
&lt;script src="https://docs.trustgrid.io/js/fullscreen.js">&lt;/script>
&lt;figure class="centered-image">
&lt;img src="config-update-fail.png" alt="" onclick="toggleImageSize(this)" style="display: block; margin-left: auto; margin-right: auto; ">
&lt;figcaption style="text-align: center; margin-top: 0.5rem; font-weight: lighter;">
Example Configuration Update Failure event
&lt;/figcaption>
&lt;/figure>
&lt;/li>
&lt;/ul>
&lt;h2 id="causes">Causes&lt;/h2>
&lt;p>Possible causes include:&lt;/p>
&lt;ul>
&lt;li>The node is unable to resolve Trustgrid.io DNS names, in this case specifically &lt;code>gatekeeper.trustgrid.io&lt;/code>&lt;/li>
&lt;li>The node is unable to connect to the the &lt;a href="https://docs.trustgrid.io/help-center/kb/site-requirements/#trustgrid-control-plane">entire Trustgrid Control Plane networks&lt;/a> on port 8443&lt;/li>
&lt;/ul>
&lt;h2 id="troubleshooting">Troubleshooting&lt;/h2>
&lt;p>These steps should be performed via the Terminal or the &lt;a href="https://docs.trustgrid.io/tutorials/local-console-utility/troubleshooting/#network-tools-shell">appliance console Network Tools Shell&lt;/a>.&lt;/p>
&lt;ol>
&lt;li>Test DNS Resolution
&lt;ol>
&lt;li>Determine the configured DNS server by viewing the WAN interface in the portal.&lt;/li>
&lt;li>Use &lt;code>dig @&amp;lt;DNS IP&amp;gt; gatekeeper.trustgrid.io +short&lt;/code> to confirm you get a response from each of your DNS servers. E.g. if the appliance is configured to use 8.8.8.8 and 1.1.1.1 use the commands &lt;code>dig @8.8.8.8 gatekeeper.trustgrid.io +short&lt;/code> and &lt;code>dig @1.1.1.1 gatekeeper.trustgrid.io +short&lt;/code>&lt;/li>
&lt;li>If the above does not resolve, make sure any firewall or access control list between the node and the WAN interface IP allows the IP to make DNS connections to the configured DNS servers on TCP &amp;amp; UDP port 53. If it successfully resolves, continue to the next step.&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Confirm Network connectivity to the rest api endpoint with the command &lt;div class="codeblock-container">
&lt;pre>&lt;code>nc -vz gatekeeper.trustgrid.io 8443&lt;/code>&lt;/pre>
&lt;button onclick="copyToClipboard(this)">Copy&lt;/button>
&lt;/div>
&lt;script>
function copyToClipboard(element) {
var text = element.previousElementSibling.textContent;
navigator.clipboard.writeText(text).then(function() {
console.log('Text copied to clipboard');
}).catch(function(err) {
console.error('Could not copy text: ', err);
});
}
&lt;/script>
&lt;style>
.codeblock-container {
position: relative;
display: flex;
align-items: center;
}
.codeblock-container pre {
margin: 0;
font-family: monospace;
background-color: #f4f4f4;
padding: 10px;
border-radius: 5px;
flex-grow: 1;
}
.codeblock-container button {
margin-left: 10px;
padding: 5px 10px;
border: none;
border-radius: 5px;
cursor: pointer;
&amp;:active {
background-color: rgb(200, 200, 200);
}
}
&lt;/style>
&lt;ol>
&lt;li>If this succeeds as shown in this image proceed to the next troubleshooting step.
&lt;script src="https://docs.trustgrid.io/js/fullscreen.js">&lt;/script>
&lt;figure class="centered-image">
&lt;img src="nc-gatekeeper-success.png" alt="" onclick="toggleImageSize(this)" style="display: block; margin-left: auto; margin-right: auto; width: 75%;">
&lt;/figure>
&lt;/li>
&lt;li>If this fails, confirm any firewall or access control list allows connectivity to &lt;a href="https://docs.trustgrid.io/help-center/kb/site-requirements/#trustgrid-control-plane">all required control plane networks&lt;/a> on TCP port 8443.&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Follow &lt;a href="https://docs.trustgrid.io/help-center/kb/startup-process/ssl-tls-tampering/#verification">these instructions to verify nothing is interfering with the TLS certificate chain.&lt;/a>&lt;/li>
&lt;li>Attempt to run the command: &lt;div class="codeblock-container">
&lt;pre>&lt;code>curl https://gatekeeper.trustgrid.io:8443/domain-info&lt;/code>&lt;/pre>
&lt;button onclick="copyToClipboard(this)">Copy&lt;/button>
&lt;/div>
&lt;script>
function copyToClipboard(element) {
var text = element.previousElementSibling.textContent;
navigator.clipboard.writeText(text).then(function() {
console.log('Text copied to clipboard');
}).catch(function(err) {
console.error('Could not copy text: ', err);
});
}
&lt;/script>
&lt;style>
.codeblock-container {
position: relative;
display: flex;
align-items: center;
}
.codeblock-container pre {
margin: 0;
font-family: monospace;
background-color: #f4f4f4;
padding: 10px;
border-radius: 5px;
flex-grow: 1;
}
.codeblock-container button {
margin-left: 10px;
padding: 5px 10px;
border: none;
border-radius: 5px;
cursor: pointer;
&amp;:active {
background-color: rgb(200, 200, 200);
}
}
&lt;/style>
The expected output is &lt;div class="codeblock-container">
&lt;pre>&lt;code>{"error":"node not authorized"}&lt;/code>&lt;/pre>
&lt;button onclick="copyToClipboard(this)">Copy&lt;/button>
&lt;/div>
&lt;script>
function copyToClipboard(element) {
var text = element.previousElementSibling.textContent;
navigator.clipboard.writeText(text).then(function() {
console.log('Text copied to clipboard');
}).catch(function(err) {
console.error('Could not copy text: ', err);
});
}
&lt;/script>
&lt;style>
.codeblock-container {
position: relative;
display: flex;
align-items: center;
}
.codeblock-container pre {
margin: 0;
font-family: monospace;
background-color: #f4f4f4;
padding: 10px;
border-radius: 5px;
flex-grow: 1;
}
.codeblock-container button {
margin-left: 10px;
padding: 5px 10px;
border: none;
border-radius: 5px;
cursor: pointer;
&amp;:active {
background-color: rgb(200, 200, 200);
}
}
&lt;/style>
&lt;ol>
&lt;li>If you receive no response this indicates the connection is still failing.&lt;/li>
&lt;li>If you receive a different response Trustgrid support will likely need to assist in troubleshooting.&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol></description></item><item><title>Help-Center: Edge Node Behavior When DNS Resolution Fails</title><link>https://docs.trustgrid.io/help-center/kb/startup-process/dns-failure/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/help-center/kb/startup-process/dns-failure/</guid><description>
&lt;h2 id="symptoms">Symptoms&lt;/h2>
&lt;ul>
&lt;li>Node does not connect to the Portal&lt;/li>
&lt;li>Packet captures show repeated DNS queries for gatekeeper.trustgrid.io but no response&lt;/li>
&lt;/ul>
&lt;h2 id="cause">Cause&lt;/h2>
&lt;ul>
&lt;li>DNS servers configured on edge node are not accessible&lt;/li>
&lt;li>A firewall is blocking TCP/UDP port 53 between the edge node and the configured DNS&lt;/li>
&lt;li>DNS servers configured on edge node cannot resolve public DNS entries for the trustgrid.io domain&lt;/li>
&lt;/ul>
&lt;h2 id="troubleshooting-steps">Troubleshooting Steps&lt;/h2>
&lt;ul>
&lt;li>Determine the configured DNS Servers - Connecting a monitor to the node will display the current IP configuration including the DNS Servers as shown below: &lt;img src="dns.png" alt="img">&lt;/li>
&lt;li>(If possible) Capture traffic between the edge node and the internet and confirm you see both a DNS query (usually for gatekeeper.trustgrid.io) &lt;strong>AND&lt;/strong> response &lt;img src="pcap.png" alt="img">&lt;/li>
&lt;/ul>
&lt;h2 id="resolution">Resolution&lt;/h2>
&lt;ul>
&lt;li>Ensure the edge node can make TCP/UDP connection on port 53 to the configured DNS server&lt;/li>
&lt;li>If using private DNS server ensure they have forwarders configured that can resolve trustgrid.io DNS records&lt;/li>
&lt;li>If configured DNS servers are incorrect the node will need to be manually reconfigured. Contact Trustgrid Support for assistance&lt;/li>
&lt;/ul></description></item><item><title>Help-Center: Edge Node Behavior When Port 8443 is blocked</title><link>https://docs.trustgrid.io/help-center/kb/startup-process/8443-blocked/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/help-center/kb/startup-process/8443-blocked/</guid><description>
&lt;h2 id="symptoms">Symptoms&lt;/h2>
&lt;ul>
&lt;li>Node will not connect to the portal&lt;/li>
&lt;li>Packet capture shows the following behavior:
&lt;ul>
&lt;li>DNS request and response for gatekeeper.trustgrid.io and zuul.trustgrid.io&lt;/li>
&lt;li>TCP connection attempt to port 8443 on the returned IP address with no response&lt;/li>
&lt;li>A 2 minute delay before the above cycle repeats&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="cause">Cause&lt;/h2>
&lt;ul>
&lt;li>The Trustgrid edge node cannot connect to the &lt;a href="https://docs.trustgrid.io/help-center/kb/site-requirements/">Trustgrid control plane&lt;/a> over 8443&lt;/li>
&lt;/ul>
&lt;h2 id="verification">Verification&lt;/h2>
&lt;ul>
&lt;li>Place a device in the same network (or assume the IP address of) the edge node. Confirm you can make a successful connection to gatekeeper.trustgrid.io:8443 using telnet, netcat or similar tool&lt;/li>
&lt;/ul>
&lt;h2 id="resolution">Resolution&lt;/h2>
&lt;ul>
&lt;li>Adjust firewall settings to ensure TCP traffic over port 8443 is allowed to all of the &lt;a href="https://docs.trustgrid.io/help-center/kb/site-requirements/">Trustgrid control plane&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Help-Center: Edge Node Behavior When SSL / TLS Certificate is Altered</title><link>https://docs.trustgrid.io/help-center/kb/startup-process/ssl-tls-tampering/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/help-center/kb/startup-process/ssl-tls-tampering/</guid><description>
&lt;div class="pageinfo pageinfo-primary">
&lt;p>Products that alter SSL/TLS certificate chains will prevent the node from functioning normally.&lt;/p>
&lt;/div>
&lt;h2 id="symptoms">Symptoms&lt;/h2>
&lt;ul>
&lt;li>Node will not connect - This will occur if the SSL/TLS chain is altered on port 8443&lt;/li>
&lt;li>Node will not update - This will occur if the SSL/TLS chain is altered on port 443&lt;/li>
&lt;li>Packet captures will show something like the below repeating:&lt;/li>
&lt;li>
&lt;ul>
&lt;li>TLS “Client Hello”&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;ul>
&lt;li>Server (Trustgrid IP) will send a reset (RST) &lt;img src="pcap.png" alt="img">&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="cause">Cause&lt;/h2>
&lt;p>The integrity of communication is a critical feature of Trustgrid’s network solution. Any product that alters the SSL certificate chain will prevent the node from functioning normally.&lt;/p>
&lt;p>Typically this is caused by a security appliance (Next Generation Firewall or Web Proxy) doing some form of SSL Decryption (e.g. DPI-SSL, HTTPS inspection)&lt;/p>
&lt;h2 id="verification">Verification&lt;/h2>
&lt;p>To verify this is indeed occurring you can run the below command from the Trustgrid terminal:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>openssl s_client -connect repo.trustgrid.io:443 -showcerts
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This example is testing connectivity to the Trustgrid repository used for updates. You can replace &lt;code>repo.trustgrid.io:443&lt;/code> with &lt;code>gatekeeper.trustgrid.io:8443&lt;/code> to test connectivity to a Trustgrid service over 8443.&lt;/p>
&lt;p>After running you will need to scroll back to the top to see the first certificate in the chain&lt;/p>
&lt;p>If the certificate chain is being altered you will see something like the below where Trustgrid is not the first entry:&lt;/p>
&lt;p>&lt;img src="openssl.png" alt="img">&lt;/p>
&lt;p>The correct certiticate chain should look like:&lt;/p>
&lt;p>&lt;img src="cert.png" alt="img">&lt;/p>
&lt;h2 id="resolution">Resolution&lt;/h2>
&lt;ul>
&lt;li>Traffic on ports 443 and 8443 between the Trustgrid node and the &lt;a href="https://docs.trustgrid.io/help-center/kb/site-requirements/">Trustgrid public IPs&lt;/a> and/or *.trustgrid.io must be excluded from any SSL/TLS decryption/inspection&lt;/li>
&lt;li>After excluding the traffic, restart the edge node&lt;/li>
&lt;/ul></description></item></channel></rss>