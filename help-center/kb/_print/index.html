<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel=canonical type=text/html href=https://docs.trustgrid.io/help-center/kb/><link rel=alternate type=application/rss+xml href=https://docs.trustgrid.io/help-center/kb/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Knowledge Base |</title><meta name=description content="Trustgrid Network Device and API documentation"><meta property="og:title" content="Knowledge Base"><meta property="og:description" content="Trustgrid Network Device and API documentation"><meta property="og:type" content="website"><meta property="og:url" content="https://docs.trustgrid.io/help-center/kb/"><meta itemprop=name content="Knowledge Base"><meta itemprop=description content="Trustgrid Network Device and API documentation"><meta name=twitter:card content="summary"><meta name=twitter:title content="Knowledge Base"><meta name=twitter:description content="Trustgrid Network Device and API documentation"><link rel=preload href=/scss/main.min.6911289b253d329975de94bccbb593efad1070b6c5994295bc8c67bcf661e005.css as=style><link href=/scss/main.min.6911289b253d329975de94bccbb593efad1070b6c5994295bc8c67bcf661e005.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
<link rel=stylesheet href=/css/prism.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-99793053-3"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-99793053-3")}</script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 469 106"><defs><style>.cls-1{fill:#6b6b6b}.cls-2{fill:#226ce0}</style></defs><title>Trustgrid-Logo-Grey</title><path class="cls-1" d="M.35 28.58H29.26V-.33H.35zM7.13 6.45H22.47V21.8H7.13z"/><path class="cls-1" d="M67.82-.33H38.9V28.58H67.82zM61 21.8H45.68V6.45H61z"/><path class="cls-1" d="M.35 67.13H29.26V38.22H.35zM7.13 45H22.47V60.35H7.13z"/><path class="cls-1" d="M106.36 38.22H77.45v12.3H67.82V41.27L85.26 23.83l-3.06-3L64.76 38.22H38.9V67.13H67.82V54.83h9.63v12.3h12.3V80.39h4.31V67.13h12.3zM61 60.35H45.68V45H61zm38.55.0H84.23V45H99.58z"/><path class="cls-1" d="M.35 105.69H29.26V76.77H.35zM7.13 83.55H22.47V98.9H7.13z"/><path class="cls-1" d="M38.9 105.69H67.82V76.77H38.9zm6.78-22.14H61V98.9H45.68z"/><path class="cls-2" d="M153.94 77.54a18.64 18.64.0 01-10.1 3.17 11.44 11.44.0 01-8.3-3c-2.12-2-3.18-5.12-3.18-9.24V44.56h-6.11V38.78h6.11V27.22H140V38.78h13.2v5.78H140V67q0 3.59 1.31 5.13a4.8 4.8.0 003.91 1.55 13.59 13.59.0 006.67-2z"/><path class="cls-2" d="M176.74 39.56A18 18 0 01186 37.07V44.4q-6.58-.24-10.66 3.42a14.51 14.51.0 00-4.64 9.85V80.39h-7.57V37.32h7.57V46.6a15.52 15.52.0 016-7"/><path class="cls-2" d="M232.34 37.32V80.39h-7.65V71.27q-4.23 9.2-16 9.36-7.48.0-11.72-4.44t-4.24-12.25V37.32h7.66V61.9q0 5.46 3 8.51a10.87 10.87.0 008.18 3.06 12.11 12.11.0 009.57-4.28 16 16 0 003.54-10.7V37.32z"/><path class="cls-2" d="M260.47 44.24a21.21 21.21.0 00-6.15-1 10.48 10.48.0 00-5.49 1.26 4.21 4.21.0 00-2.08 3.87 4.3 4.3.0 002.32 4 34.68 34.68.0 007 2.73 54.86 54.86.0 017.33 2.6 13 13 0 014.85 3.83 10.51 10.51.0 012 6.67 10.58 10.58.0 01-4.6 9.29 19.65 19.65.0 01-11.44 3.17 28.35 28.35.0 01-9.32-1.55 21.07 21.07.0 01-7.61-4.39l2.85-5.54a20.07 20.07.0 006.63 3.91 22 22 0 007.69 1.47 11.45 11.45.0 006-1.39 4.61 4.61.0 002.28-4.23 4.82 4.82.0 00-2.4-4.4 32.85 32.85.0 00-7.29-2.93 48.4 48.4.0 01-7-2.48 12.43 12.43.0 01-4.64-3.71A10 10 0 01239.5 49q0-6 4.4-9a19.07 19.07.0 0111-3 27.13 27.13.0 017.69 1.1 23 23 0 016.56 3l-2.77 5.78a26 26 0 00-5.9-2.6"/><path class="cls-2" d="M303.42 77.54a18.64 18.64.0 01-10.1 3.17 11.44 11.44.0 01-8.3-3c-2.12-2-3.18-5.12-3.18-9.24V44.56h-6.11V38.78h6.11V27.22h7.65V38.78h13.19v5.78H289.49V67c0 2.39.44 4.1 1.3 5.13a4.81 4.81.0 003.91 1.55 13.62 13.62.0 006.68-2z"/><path class="cls-1" d="M352.92 36.34V76.48a19.18 19.18.0 01-3 10.71 19.61 19.61.0 01-8.43 7.08A29.79 29.79.0 01329 96.75a36.74 36.74.0 01-10.66-1.54 34 34 0 01-9-4.16l5.05-10a25.68 25.68.0 006.51 3.17 22.5 22.5.0 007.08 1.14 12.11 12.11.0 007.74-2.27 7.52 7.52.0 002.85-6.2V72.16Q334.12 77.95 326 78a17.69 17.69.0 01-16.41-10.14 24.71 24.71.0 01-2.4-11.12 24.42 24.42.0 012.32-10.91A17.35 17.35.0 01316 38.46a17.92 17.92.0 019.61-2.61A17.42 17.42.0 01333 37.36a14.36 14.36.0 015.5 4.35V36.34zM336.07 64.51a11 11 0 002.44-7.41 11.16 11.16.0 00-2.44-7.49 8.69 8.69.0 00-12.91.0 11 11 0 00-2.48 7.45 10.85 10.85.0 002.48 7.41 8.18 8.18.0 006.47 2.85 8.08 8.08.0 006.44-2.85"/><path class="cls-1" d="M383.9 37.8a16.63 16.63.0 018.26-2V49c-.49.0-1.22-.08-2.2-.08a13.4 13.4.0 00-8.3 2.4A9.18 9.18.0 00378 57.92V80.39H363.5v-44H378v7.33a16 16 0 015.9-5.87"/><path class="cls-1" d="M411.09 18.22a7.55 7.55.0 012.16 5.58 7.59 7.59.0 01-2.16 5.54 8 8 0 01-11 0 7.59 7.59.0 01-2.16-5.54 7.55 7.55.0 012.16-5.58 8.1 8.1.0 0111 0M398.51 36.34h14.41V80.39H398.51z"/><path class="cls-1" d="M468.45 20V80.39H454v-5.7a14.92 14.92.0 01-5.58 4.68A16.94 16.94.0 01440.93 81a20.15 20.15.0 01-10.75-2.85 19.16 19.16.0 01-7.2-8 26.51 26.51.0 01-2.57-11.93 25.77 25.77.0 012.53-11.72A18.6 18.6.0 01430 38.62a20.05 20.05.0 0110.59-2.77 17.24 17.24.0 017.61 1.63A16.19 16.19.0 01454 42.12V20zm-17.1 46.5A11.77 11.77.0 00454 58.57a11.76 11.76.0 00-2.61-8 8.58 8.58.0 00-6.84-3 8.67 8.67.0 00-6.88 3.05A11.69 11.69.0 00435 58.57a11.68 11.68.0 002.64 7.93 8.68 8.68.0 006.88 3.06 8.53 8.53.0 006.84-3.06"/><path class="cls-2" d="M99.58 21.8H84.23V6.46H99.58zM106.36-.33H77.45V28.59h28.91z"/><path class="cls-2" d="M99.58 98.9H84.23V83.55H99.58zm6.78-22.13H77.45v28.92h28.91z"/></svg></span><span class=navbar-brand__name></span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/getting-started/><span>Getting Started</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/tutorials/><span>Guides</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/help-center/><span class=active>Help Center</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/release-notes/><span>Release Notes</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.e4ab4c39078d822ac508d809e0d3a240.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/help-center/kb/>Return to the regular view of this page</a>.</p></div><h1 class=title>Knowledge Base</h1><ul><li>1: <a href=#pg-73b8b11ae883b025a015b77b28b92378>Site Requirements</a></li><li>2: <a href=#pg-a44a0fedb73fb87d19cbe335bc9d01c2>Edge Node Startup</a></li><ul><li>2.1: <a href=#pg-9fbe944c9397feb5faf372b541b55b81>Edge Node Behavior When DNS Resolution Fails</a></li><li>2.2: <a href=#pg-763cd88bff2293686fbb73cf18727d02>Edge Node Behavior When Port 8443 is blocked</a></li><ul></ul><li>2.3: <a href=#pg-36c3b42f7e2a13ec2a6ab84bca47de4a>Edge Node Behavior When SSL / TLS Certificate is Altered</a></li></ul><li>3: <a href=#pg-51182ab0d4577041da6565c724272969>Node Upgrade Process</a></li><ul><li>3.1: <a href=#pg-3aca40a485c6077a3eecb9d11ee4297f>Node Behavior When Port 443 is blocked</a></li></ul><li>4: <a href=#pg-f2bd5b3f65f66918401f6ec4e41dfc46>WAN/ISP Redundancy Configurations</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-73b8b11ae883b025a015b77b28b92378>1 - Site Requirements</h1><div class=lead>Network access requirements</div><div class="pageinfo pageinfo-primary"><p>Trustgrid’s architecture consists of Nodes deployed at the Edge (on-premise) and management infrastructure built in AWS. Nodes create tunnels to other nodes for data transfer, and to the management infrastructure for control. All tunnels are TLS connections and must be permitted by any firewall between</p></div><h3 id=network-requirements-for-all-nodes>Network Requirements for All Nodes</h3><p>In order to connect to the Trustgrid Control Plane, the following outbound traffic must be allowed from the node’s configured primary interface IP address</p><ul><li>TCP Port 443 and TCP/UDP 8443 to:<ul><li>35.171.100.16/28</li><li>34.223.12.192/28</li></ul></li><li>TCP/UDP Port 53 to the configured DNS servers. These DNS servers must be accessible from the WAN/outside interface IP and be able to resolve DNS requests for the trustgrid.io domain</li></ul><div class="alert alert-info" role=alert>Trustgrid nodes will attempt connect to 169.254.169.254 on port 80. This is a standard instance metadata server in public clouds such as AWS and Azure. This connectivity is not required outside these providers.</div><h3 id=recommendations>Recommendations</h3><p>At least 10 Mbps download speed is recommended for reasonable performance during upgrades. Actual bandwidth requirement will be specific to the workloads running across the device.</p><p>Hardware devices are recommended to be connected to ports configured for 1000 Mbps and full duplex with auto negotiation on.</p><h2 id=gateway-node-network-requirements>Gateway Node Network Requirements</h2><p>In addition to being able to connect to the Control Plane resource outlined above, Gateway Nodes must be allowed to receive inbound traffic on their configured public IP and port (typically TCP/UDP port 8443). Both the advertised public IP and port are configurable when enabling a node as a gateway.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a44a0fedb73fb87d19cbe335bc9d01c2>2 - Edge Node Startup</h1><div class=lead>A step by step description of how a healthy Edge Node starts up and connects to the Trustgrid system.</div><h2 id=startup-process>Startup Process</h2><ol><li>ARP for the default gateway</li><li>DNS request for A record for gatekeeper.trustgrid.io & zuul.trustgrid.io<ol><li>The response will be IPs in the Trustgrid AWS networks, <code>35.171.100.16/28</code> (us-east-1) or <code>34.223.12.192/28</code> (us-west-2)</li></ol></li><li>The node will initiate a connection to port 8443 on the IP addresses returned and start a TLS handshake.</li><li>After a successfully TLS handshake, the node will show as connected in the Trustgrid Portal</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-9fbe944c9397feb5faf372b541b55b81>2.1 - Edge Node Behavior When DNS Resolution Fails</h1><h2 id=symptoms>Symptoms</h2><ul><li>Node does not connect to the Portal</li><li>Packet captures show repeated DNS queries for gatekeeper.trustgrid.io but no response</li></ul><h2 id=cause>Cause</h2><ul><li>DNS servers configured on edge node are not accessible</li><li>A firewall is blocking TCP/UDP port 53 between the edge node and the configured DNS</li><li>DNS servers configured on edge node cannot resolve public DNS entries for the trustgrid.io domain</li></ul><h2 id=troubleshooting-steps>Troubleshooting Steps</h2><ul><li>Determine the configured DNS Servers - Connecting a monitor to the node will display the current IP configuration including the DNS Servers as shown below: <img src=dns.png alt=img></li><li>(If possible) Capture traffic between the edge node and the internet and confirm you see both a DNS query (usually for gatekeeper.trustgrid.io) <strong>AND</strong> response <img src=pcap.png alt=img></li></ul><h2 id=resolution>Resolution</h2><ul><li>Ensure the edge node can make TCP/UDP connection on port 53 to the configured DNS server</li><li>If using private DNS server ensure they have forwarders configured that can resolve trustgrid.io DNS records</li><li>If configured DNS servers are incorrect the node will need to be manually reconfigured. Contact Trustgrid Support for assistance</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-763cd88bff2293686fbb73cf18727d02>2.2 - Edge Node Behavior When Port 8443 is blocked</h1><h2 id=symptoms>Symptoms</h2><ul><li>Node will not connect to the portal</li><li>Packet capture shows the following behavior:<ul><li>DNS request and response for gatekeeper.trustgrid.io and zuul.trustgrid.io</li><li>TCP connection attempt to port 8443 on the returned IP address with no response</li><li>A 2 minute delay before the above cycle repeats</li></ul></li></ul><h2 id=cause>Cause</h2><ul><li>The Trustgrid edge node cannot connect to the <a href=https://docs.trustgrid.io/help-center/kb/site-requirements/>Trustgrid control plane</a> over 8443</li></ul><h2 id=verification>Verification</h2><ul><li>Place a device in the same network (or assume the IP address of) the edge node. Confirm you can make a successful connection to gatekeeper.trustgrid.io:8443 using telnet, netcat or similar tool</li></ul><h2 id=resolution>Resolution</h2><ul><li>Adjust firewall settings to ensure TCP traffic over port 8443 is allowed to all of the <a href=https://docs.trustgrid.io/help-center/kb/site-requirements/>Trustgrid control plane</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-36c3b42f7e2a13ec2a6ab84bca47de4a>2.3 - Edge Node Behavior When SSL / TLS Certificate is Altered</h1><div class="pageinfo pageinfo-primary"><p>Products that alter SSL/TLS certificate chains will prevent the node from functioning normally.</p></div><h2 id=symptoms>Symptoms</h2><ul><li>Node will not connect - This will occur if the SSL/TLS chain is altered on port 8443</li><li>Node will not update - This will occur if the SSL/TLS chain is altered on port 443</li><li>Packet captures will show something like the below repeating:</li><li><ul><li>TLS “Client Hello”</li></ul></li><li><ul><li>Server (Trustgrid IP) will send a reset (RST) <img src=pcap.png alt=img></li></ul></li></ul><h2 id=cause>Cause</h2><p>The integrity of communication is a critical feature of Trustgrid’s network solution. Any product that alters the SSL certificate chain will prevent the node from functioning normally.</p><p>Typically this is caused by a security appliance (Next Generation Firewall or Web Proxy) doing some form of SSL Decryption (e.g. DPI-SSL, HTTPS inspection)</p><h2 id=verification>Verification</h2><p>To verify this is indeed occurring you can run the below command from the Trustgrid terminal:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl s_client -connect repo.trustgrid.io:443 -showcerts
</span></span></code></pre></div><p>This example is testing connectivity to the Trustgrid repository used for updates. You can replace <code>repo.trustgrid.io:443</code> with <code>gatekeeper.trustgrid.io:8443</code> to test connectivity to a Trustgrid service over 8443.</p><p>After running you will need to scroll back to the top to see the first certificate in the chain</p><p>If the certificate chain is being altered you will see something like the below where Trustgrid is not the first entry:</p><p><img src=openssl.png alt=img></p><p>The correct certiticate chain should look like:</p><p><img src=cert.png alt=img></p><h2 id=resolution>Resolution</h2><ul><li>Traffic on ports 443 and 8443 between the Trustgrid node and the <a href=https://docs.trustgrid.io/help-center/kb/site-requirements/>Trustgrid public IPs</a> and/or *.trustgrid.io must be excluded from any SSL/TLS decryption/inspection</li><li>After excluding the traffic, restart the edge node</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-51182ab0d4577041da6565c724272969>3 - Node Upgrade Process</h1><div class=lead>A step by step description of how a healthy node appliance upgrades.</div><h2 id=update-process>Update Process</h2><ol><li>DNS request for A record of repo.trustgrid.io<ol><li>The response will be IPs in the Trustgrid AWS networks, <code>35.171.100.16/28</code> (us-east-1) or <code>34.223.12.192/28</code> (us-west-2)</li></ol></li><li>The node will initiate a connection to <strong>port 443</strong> on the ip address returned for repo.trustgrid.io</li><li>The update process will download any updated packages using port</li></ol><h2 id=potential-issues>Potential Issues</h2><ul><li><a href=https://docs.trustgrid.io/help-center/kb/upgrade-process/443-blocked/>Confirm connectivity on Port 443</a></li><li><a href=https://docs.trustgrid.io/help-center/kb/startup-process/ssl-tls-tampering/>Verify no DPI-SSL or HTTPS proxy</a> is interfering with the SSL certificate for repo.trustgrid.io</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-3aca40a485c6077a3eecb9d11ee4297f>3.1 - Node Behavior When Port 443 is blocked</h1><h2 id=symptoms>Symptoms</h2><ul><li>Node will not update either automatically or when manually triggered</li><li>Node will not be able to pull down container images from the organization repository</li></ul><h2 id=cause>Cause</h2><ul><li>The Trustgrid node cannot connect to repo.trustgrid.io on port 443 to update packages</li></ul><h2 id=resolution>Resolution</h2><ul><li>Confirm the node can resolve repo.trustgrid.io</li><li>Ensure the node can connect to repo.trustgrid.io:443</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-f2bd5b3f65f66918401f6ec4e41dfc46>4 - WAN/ISP Redundancy Configurations</h1><div class=lead>Shows different way Trustgrid nodes can utilize multiple WAN or ISP connections for redundancy</div><div class="pageinfo pageinfo-primary">The sections below provide examples of how Trustgrid nodes can be deployed to provide WAN/ISP redundancy</div><h2 id=behind-firewallrouter-with-multiple-isp-connections>Behind Firewall/Router with Multiple ISP Connections</h2><p>In this configuration the Trustgrid WAN interfaces are behind a firewall or router that has two independent ISP connections to provide internet access.</p><p>The firewall or router is responsible for either failing over outbound traffic in the event of an ISP failure, or to route different nodes to utilize specific ISP connections.</p><p>The WAN interface of the Trustgrid node would utilize <strong>private IPs</strong> in this configuration that are NAT&rsquo;d to public IPs by the firewall/router.<div class="alert alert-info" role=alert><p>This is the only configuration that:</p><ul><li>Supports <strong>Single Node</strong> deployments</li><li>Supports <strong>Single Interface</strong> configurations</li></ul></div></p><div class="alert alert-warning" role=alert>This configuration is <strong>not recommended for nodes acting as gateways</strong>. In this configuration devices are NAT&rsquo;d to a different public IP depending on which ISP is active. A gateway node can only announce a single IP or DNS address for its clients to connect to. It would be possible to announce a DNS record and some form of dynamic DNS health check to update the record if the ISP changed. But that change would have to propagate which could take some time.</div><h3 id=single-node-behind-firewall>Single Node Behind Firewall</h3><p>This configuration shows a single node connected to a firewall or router that has two ISP connected to it.</p><div class=mermaid>graph LR
intHost[Internal Hosts]
intNet[[Internal\n Network]]
intHost <-.Optional.-> intNet <-.Optional.-> snLAN
subgraph sn [Single Node]
snWAN[WAN\nInterface]
snLAN[LAN\nInterface]
snLAN ~~~ snWAN
end
firewall["Firewall/Router"]
dmzNet[[DMZ\n Network]]
firewall == Primary==> ISP1([ISP 1])
firewall -. Failover/Backup .-> ISP2([ISP 2])
snWAN --> dmzNet --> firewall
classDef tgnode fill:#346ed9,color:white
class sn tgnode</div><h3 id=clustered-nodes-behind-firewall>Clustered Nodes Behind Firewall</h3><p>This configuration shows a cluster of Trustgrid nodes connected to a firewall or router that has two ISPs connected to it.</p><div class=mermaid>graph LR
intHost[Internal Hosts]
intNet[[Internal\n Network]]
intHost <-.Optional.-> intNet <-.Optional.-> cl1LAN & cl2LAN
    subgraph cluster [" "]
subgraph Cluster-Node1
cl1WAN[WAN\nInterface]
cl1LAN[LAN\nInterface]
cl1LAN ~~~ cl1WAN
end
subgraph Cluster-Node2
cl2WAN[WAN\nInterface]
cl2LAN[LAN\nInterface]
cl2LAN ~~~ cl2WAN
end
end
dmzNet[[DMZ\n Network]]
firewall["Firewall/Router"]
firewall == Primary==> ISP1([ISP 1])
firewall -. Failover/Backup .-> ISP2([ISP 2])
cl1WAN & cl2WAN --> dmzNet --> firewall
  classDef tgnode fill:#346ed9,color:white
class Cluster-Node1,Cluster-Node2 tgnode
style cluster fill:#c8c8c8</div><h2 id=cluster-wan-interface-to-different-networks>Cluster WAN Interface to Different Networks</h2><p>Another method of providing redundancy takes advantage of Trustgrid <a href=https://docs.trustgrid.io/docs/clusters/>clustering</a> by connecting each member of the cluster to a different ISP on their WAN interface. This could be done by:</p><ul><li>Directly attaching each member WAN interface to a different ISP handoff</li><li>Connecting each member WAN interface to different DMZ private networks configured to use different ISPs for internet access</li><li>A combination of public and private WAN networks</li></ul><p>In this configuration, the master/active member of the node will determine which ISP is being utilized. If one ISP is preferred you will need to have operational procedures in place to ensure the member node connected to it stays the master node. It is recommended that you keep the <a href=https://docs.trustgrid.io/docs/clusters/#cluster-mode>cluster mode configured as Automatic Failback</a> and your organization establishes a <a href=https://docs.trustgrid.io/docs/nodes/tags/>tag</a> to designate the preferred member.</p><div class="alert alert-info" role=alert>Because the WAN interfaces are on different networks, this configuration <strong>requires at least one additional LAN interface</strong> to be configured for accessing internal resources and providing the <a href=https://docs.trustgrid.io/docs/clusters/#cluster-heartbeat-communication>cluster heartbeat</a> communication</div><h3 id=cluster-wan-direct-connections-to-multiple-isps>Cluster WAN Direct Connections to Multiple ISPs</h3><p>This configuration shows Cluster-Node1&rsquo;s WAN interface directly connected to one ISP. And Cluster-Node2&rsquo;s WAN interface is connected directly to another ISP.</p><div class=mermaid>graph LR
intHost[Internal Hosts]
intNet[[Internal\n Network]]
intHost <---> intNet <---> cl1LAN & cl2LAN
    subgraph cluster [" "]
subgraph Cluster-Node1
cl1WAN[WAN\nInterface]
cl1LAN[LAN\nInterface]
cl1LAN ~~~ cl1WAN
end
subgraph Cluster-Node2
cl2WAN[WAN\nInterface]
cl2LAN[LAN\nInterface]
cl2LAN ~~~ cl2WAN
end
end
cl1WAN ==> ISP1([ISP 1])
cl2WAN ==> ISP2([ISP 2])
classDef tgnode fill:#346ed9,color:white
class Cluster-Node1,Cluster-Node2 tgnode
style cluster fill:#c8c8c8</div><h3 id=cluster-wan-to-separate-dmz-networks>Cluster WAN to separate DMZ networks</h3><p>This configuration shows Cluster-Node1&rsquo;s WAN interface is connected to one DMZ/private network that is behind a firewall connected to one ISP. And Cluster-Node2&rsquo;s WAN interface is connected to a second DMZ network behind a separate firewall connected to a different ISP.</p><div class=mermaid>graph LR
intHost[Internal Hosts]
intNet[[Internal\n Network]]
intHost <---> intNet <---> cl1LAN & cl2LAN
    subgraph cluster [" "]
subgraph Cluster-Node1
cl1WAN[WAN\nInterface]
cl1LAN[LAN\nInterface]
cl1LAN ~~~ cl1WAN
end
subgraph Cluster-Node2
cl2WAN[WAN\nInterface]
cl2LAN[LAN\nInterface]
cl2LAN ~~~ cl2WAN
end
end
dmzNet1[[DMZ\n Network 1]]
dmzNet2[[DMZ\n Network 2]]
firewall1["Firewall/Router 1"]
firewall2["Firewall/Router 2"]
cl1WAN --> dmzNet1 --> firewall1 ==> ISP1([ISP 1])
cl2WAN --> dmzNet2 --> firewall2 ==> ISP2([ISP 2])
classDef tgnode fill:#346ed9,color:white
class Cluster-Node1,Cluster-Node2 tgnode
style cluster fill:#c8c8c8</div><div class="alert alert-info" role=alert>Note: While shown with two separate firewall/routers, this could also be accomplished with a single firewall/router configured to route each DMZ network to a different ISP.</div><h3 id=cluster-wan-using-mix-of-public-and-dmz-networks>Cluster WAN using mix of public and DMZ networks</h3><p>This configuration shows Cluster-Node1&rsquo;s WAN interface is connected to a private DMZ network behind a firewall that is using ISP 1. Cluster-Node2&rsquo;s WAN interface is connected directly to ISP 2.</p><div class=mermaid>graph LR
intHost[Internal Hosts]
intNet[[Internal\n Network]]
intHost <---> intNet <---> cl1LAN & cl2LAN
    subgraph cluster [" "]
subgraph Cluster-Node1
cl1WAN[WAN\nInterface]
cl1LAN[LAN\nInterface]
cl1LAN ~~~ cl1WAN
end
subgraph Cluster-Node2
cl2WAN[WAN\nInterface]
cl2LAN[LAN\nInterface]
cl2LAN ~~~ cl2WAN
end
end
dmzNet1[[DMZ\n Network 1]]
firewall1["Firewall/Router 1"]
cl1WAN --> dmzNet1 --> firewall1 ==> ISP1([ISP 1])
cl2WAN ==> ISP2([ISP 2])
classDef tgnode fill:#346ed9,color:white
class Cluster-Node1,Cluster-Node2 tgnode
style cluster fill:#c8c8c8</div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=LinkedIn aria-label=LinkedIn><a class=text-white target=_blank rel=noopener href=https://www.linkedin.com/company/trustgrid/ aria-label=LinkedIn><i class="fab fa-linkedin"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/trustgrid aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Trustgrid All Rights Reserved</small>
<small class=ml-1><a href=https://trustgrid.io target=_blank rel=noopener>Privacy Policy</a></small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/mermaid@9.2.2/dist/mermaid.min.js integrity="sha512-IX+bU+wShHqfqaMHLMrtwi4nK6W/Z+QdZoL4kPNtRxI2wCLyHPMAdl3a43Fv1Foqv4AP+aiW6hg1dcrTt3xc+Q==" crossorigin=anonymous></script>
<script src=/js/main.min.eb0d5914014c9e8699b3e0109eff69ebdcde4f5e0c80993229a0ebfa76596d0b.js integrity="sha256-6w1ZFAFMnoaZs+AQnv9p69zeT14MgJkyKaDr+nZZbQs=" crossorigin=anonymous></script>
<script src=/js/prism.js></script>
<script src=/js/tabpane-persist.js></script></body></html>