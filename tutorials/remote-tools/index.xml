<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>â€“ Remote VPN Tools</title><link>https://docs.trustgrid.io/tutorials/remote-tools/</link><description>Recent content in Remote VPN Tools on</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://docs.trustgrid.io/tutorials/remote-tools/index.xml" rel="self" type="application/rss+xml"/><item><title>Tutorials: Ping Remote Virtual Host</title><link>https://docs.trustgrid.io/tutorials/remote-tools/ping-remote-virtual-host/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/tutorials/remote-tools/ping-remote-virtual-host/</guid><description>
&lt;h2 id="prerequisites">Prerequisites&lt;/h2>
&lt;ul>
&lt;li>Both the source and destination nodes should have a virtual management IP configured
&lt;ul>
&lt;li>There should be a unique IP under Node &amp;gt; Configuration &amp;gt; VPN &amp;gt; Virtual Management IP&lt;/li>
&lt;li>In the virtual network route configuration in your domain, a route should exist with the following settings:
&lt;ul>
&lt;li>Destination: node name (even if part of a cluster)&lt;/li>
&lt;li>Destination CIDR: virtual management IP with a /32 suffix&lt;/li>
&lt;li>Metric: 1&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Use the &lt;a href="https://docs.trustgrid.io/tutorials/remote-tools/view-virtual-route-table/">View Virtual Route Table&lt;/a> tool to verify both the source and destination nodes have valid, available routes to each other&amp;rsquo;s virtual management IP&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Need to know the virtual IP address of the inside NAT if targeting a local IP on the destination network&lt;/li>
&lt;li>Need to know the virtual management IP address of the destination node if only verifying VPN network connectivity&lt;/li>
&lt;/ul>
&lt;div class="alert alert-info" role="alert">
The &lt;a href="https://docs.trustgrid.io/tutorials/gateway-tools/ping-remote-node/">Ping Remote Node&lt;/a> tool allows you to verify data plane communication by node name
&lt;/div>
&lt;h2 id="usage">Usage&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>Login to the Trustgrid portal and navigate to the Node from which you want to test connectivity.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select &lt;code>VPN&lt;/code> under the &lt;code>Network&lt;/code> section.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click the &lt;code>Tools&lt;/code> button and select the &lt;code>Ping Remote Virtual Host&lt;/code> option from the &lt;code>Select a service&lt;/code> dropdown.&lt;/p>
&lt;p>&lt;img src="ping-remote-modal.png" alt="Ping Remote Host Dialog">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Modify the host parameter to the target virtual IP address and click &lt;code>Execute&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>A window will pop up with the content like below.&lt;/p>
&lt;p>&lt;img src="ping-output.png" alt="Ping Output">&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="responses">Responses&lt;/h2>
&lt;p>There are several configuration elements that need to be configured and working for a VPN deployment to be successful. When something is not configured correctly, the trustgrid node responds to an ICMP ping with a variety of different &amp;ldquo;Destination Unreachable&amp;rdquo; error messages that can indicate what exactly appears to be wrong. Here are the error responses the node may give when attempting to ping a remote machine through the VPN when something is amiss.&lt;/p>
&lt;h3 id="destination-net-unknown">Destination Net Unknown&lt;/h3>
&lt;p>This error means that the node cannot find an interface network binding with an inside and outside nat that match the requests source and destination IP. You should re-examine the inside and outside nats for the node interface that is receiving the packet, and make sure that an inside nat is defined that matches the source machines local IP and an outside nat that matches the virtual destination IP (or that no outside nat is present, which defaults to 1x1).&lt;/p>
&lt;h3 id="destination-net-unreachable">Destination Net Unreachable&lt;/h3>
&lt;p>This error means that the node cannot find a route defined at the domain/network level for the destination IP in this request. You should examine the domain route definitions and make sure that one is included for the virtual destination IP address you are trying to ping. Use the &lt;a href="https://docs.trustgrid.io/tutorials/remote-tools/view-virtual-route-table/">View Virtual Route Table&lt;/a> tool using the target IP as a filter to confirm the route exists and is available.&lt;/p>
&lt;h3 id="destination-host-unreachable">Destination Host Unreachable&lt;/h3>
&lt;p>This error indicates that there is a route defined for the ping dest IP, but that the destination node associated with the route is not currently connected to this node. You should look at the routes in the source node&amp;rsquo;s detail page in the portal and make sure that there is one included for the destination node that should be receiving the request.&lt;/p>
&lt;h3 id="packet-filtered">Packet Filtered&lt;/h3>
&lt;p>This error results when the ping request could not be performed do to the lack of a domain network ACL allowing the request. While this itself only indicates that ICMP traffic is not allowed between these two hosts in this direction, it can be used as a valuable indicator of a bigger policy issue. Check your ACL list in the portal to ensure that icmp are allowed between these to hosts.&lt;/p>
&lt;h3 id="destination-host-unknown">Destination Host Unknown&lt;/h3>
&lt;p>This error happens when the ping packet made it to the destination node, but no set of inside/outside nats could be found that include the source and destination IPs of this request. Check the destination node VPN settings to ensure an inside NAT is present for the virtual destination IP of the request, and either an outside NAT exists and includes the virtual source IP, or no outside NAT is present, which defaults to 1x1.&lt;/p>
&lt;h3 id="no-ping-response-error">No Ping Response Error&lt;/h3>
&lt;p>When a ping sits there and no response is received, usually the best way to troubleshoot further is to &lt;a href="https://docs.trustgrid.io/tutorials/interface-tools/sniff-interface-traffic/">sniff interface traffic&lt;/a> with a filter of &lt;code>icmp and host &amp;lt;target-ip&amp;gt;&lt;/code> on the source and dest nodes.&lt;/p>
&lt;p>When troubleshooting, keep in mind that the lack of an error likely means one of the following:&lt;/p>
&lt;ol>
&lt;li>The local node VPN interface that should be receiving the packet hasn&amp;rsquo;t been configured correctly.&lt;/li>
&lt;li>The local firewall, router or target machine isn&amp;rsquo;t correctly routing packets to the source node.&lt;/li>
&lt;li>There is an ARP issue on either the source or destination node where the node isn&amp;rsquo;t responding correctly (&lt;code>tcpdump -i &amp;lt;data_nic&amp;gt; arp&lt;/code>)&lt;/li>
&lt;li>There is no responding machine on the remote side!&lt;/li>
&lt;/ol></description></item><item><title>Tutorials: Sniff Virtual Traffic</title><link>https://docs.trustgrid.io/tutorials/remote-tools/sniff-virtual-traffic/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/tutorials/remote-tools/sniff-virtual-traffic/</guid><description>
&lt;h2 id="summary">Summary&lt;/h2>
&lt;p>This tool allows you to monitor the traffic flowing over a VPN tunnel by &amp;ldquo;sniffing&amp;rdquo; inside the tunnel. This allows traffic to be viewed after NATs have been applied and confirm traffic is routed to or from the expected node.&lt;/p>
&lt;h2 id="usage">Usage&lt;/h2>
&lt;p>This tool is accessed on a node&amp;rsquo;s detail page under the VPN panel. Select the desired attached virtual network (note: if only on virtual network is present it will be selected by default) and click the &amp;ldquo;Tools&amp;rdquo; button in the top right.
&lt;figure class="centered-image">
&lt;img src="sniff-virtual-traffic-button.png" alt="" style="display: block; margin-left: auto; margin-right: auto; width: 70%;">
&lt;figcaption style="text-align: center; margin-top: 0.5rem;font-weight:lighter;">
Sniff Virtual Traffic Button
&lt;/figcaption>
&lt;/figure>
&lt;/p>
&lt;p>Once launched, you will be prompted to provide any filters to limit the traffic displayed. The default is to show all traffic on that virtual network tunnel.&lt;/p>
&lt;figure class="centered-image">
&lt;img src="sniff-virtual-traffic-prompt.png" alt="" style="display: block; margin-left: auto; margin-right: auto; width: 50%;">
&lt;figcaption style="text-align: center; margin-top: 0.5rem;font-weight:lighter;">
Filter Prompt
&lt;/figcaption>
&lt;/figure>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Field Name&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr id="peers" style="scroll-margin-top: 10rem;">
&lt;th>Peer(s)&lt;/th>
&lt;td>Use this field to filter for traffic only between the current node and the listed peer.&lt;/td>
&lt;/tr>
&lt;tr id="protocols" style="scroll-margin-top: 10rem;">
&lt;th>Protocol(s)&lt;/th>
&lt;td>Filter to specified network protocol(s): any, tcp, udp, or icmp&lt;/td>
&lt;/tr>
&lt;tr id="hosts" style="scroll-margin-top: 10rem;">
&lt;th>Host(s)&lt;/th>
&lt;td>Filter to see traffic matching the specified &lt;strong>virtual&lt;/strong> IP address(es)&lt;/td>
&lt;/tr>
&lt;tr id="ports" style="scroll-margin-top: 10rem;">
&lt;th>Port(s)&lt;/th>
&lt;td>&lt;p>Filter to see traffic matching the specified ports. This will match either a destination or source port.
The operator on the left allows for matching based on:&lt;/p>
&lt;ul>
&lt;li>equal (=)&lt;/li>
&lt;li>not equal (!=) to exclude traffic for the specified port&lt;/li>
&lt;li>greater than (&amp;gt;) and less than (&amp;lt;)&lt;/li>
&lt;li>a port range (&amp;lt;&amp;gt;) which will show all traffic with ports between the two values&lt;/li>
&lt;/ul>
&lt;p>For ICMP, this field does not apply.&lt;/p>
&lt;/td>
&lt;/tr>
&lt;tr id="tcp-flags" style="scroll-margin-top: 10rem;">
&lt;th>TCP Flags&lt;/th>
&lt;td>&lt;p>Only applies to TCP traffic. It can filter based on the following flags:&lt;/p>
&lt;ul>
&lt;li>S = SYN - The start of a new TCP connection&lt;/li>
&lt;li>. = ACK - Acknowledges received data&lt;/li>
&lt;li>P = PSH - Data is ready to be read by the application&lt;/li>
&lt;li>F = FIN - Closing the connection&lt;/li>
&lt;li>R = RST - Resetting the connection&lt;/li>
&lt;/ul>
&lt;p>More than one flag can be specified, such as &amp;ldquo;S.&amp;rdquo; to show only traffic with SYN &lt;strong>or&lt;/strong> ACK flags set.&lt;/p>
&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="alert alert-info" role="alert">
For the peer, protocol, host, and ports fields additional values can be provided to filter for more than one item. When multiple values are listed they are combined in using an &lt;strong>OR&lt;/strong> operator. Packets matching any of the listed values will be shown.
&lt;/div>
&lt;h2 id="output">Output&lt;/h2>
&lt;p>Below shows sample output from using this tool to monitor traffic on a virtual network between two nodes:&lt;/p>
&lt;figure class="centered-image">
&lt;img src="sniff-virtual-traffic-output.png" alt="" style="display: block; margin-left: auto; margin-right: auto; width: 80%;">
&lt;figcaption style="text-align: center; margin-top: 0.5rem;font-weight:lighter;">
Sample Output
&lt;/figcaption>
&lt;/figure>
&lt;p>The output includes the following data for each packet:
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Field Name&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr id="timestamp" style="scroll-margin-top: 10rem;">
&lt;th>Timestamp&lt;/th>
&lt;td>The time the packet was seen&lt;/td>
&lt;/tr>
&lt;tr id="peer" style="scroll-margin-top: 10rem;">
&lt;th>Peer&lt;/th>
&lt;td>The source or destination node of the packet&lt;/td>
&lt;/tr>
&lt;tr id="remote-virtual-ipport" style="scroll-margin-top: 10rem;">
&lt;th>Remote Virtual IP:Port&lt;/th>
&lt;td>The virtual IP address and port of the source or destination remote endpoint&lt;/td>
&lt;/tr>
&lt;tr id="direction-indicator" style="scroll-margin-top: 10rem;">
&lt;th>Direction Indicator&lt;/th>
&lt;td>&lt;p>The symbols indicating if the packet was sent or received by the local node:&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;lt;&lt;/code> indicates the local node sent the packet to the peer&lt;/li>
&lt;li>&lt;code>&amp;gt;&lt;/code> indicates the remote peer sent the packet to the local node&lt;/li>
&lt;/ul>
&lt;/td>
&lt;/tr>
&lt;tr id="local-virtual-ipport" style="scroll-margin-top: 10rem;">
&lt;th>Local Virtual IP:Port&lt;/th>
&lt;td>The virtual IP address and port of the local endpoint&lt;/td>
&lt;/tr>
&lt;tr id="packet-header-information" style="scroll-margin-top: 10rem;">
&lt;th>Packet Header Information&lt;/th>
&lt;td>&lt;p>Additional metadata about the packet such as:&lt;/p>
&lt;ul>
&lt;li>protocol&lt;/li>
&lt;li>TCP flags&lt;/li>
&lt;li>sequence and acknowledgement numbers&lt;/li>
&lt;li>data length&lt;/li>
&lt;/ul>
&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>&lt;/p></description></item><item><title>Tutorials: View Virtual Route Table</title><link>https://docs.trustgrid.io/tutorials/remote-tools/view-virtual-route-table/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/tutorials/remote-tools/view-virtual-route-table/</guid><description>
&lt;h2 id="usage">Usage&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>Login to the Trustgrid portal and navigate to the Node from which you want to test connectivity.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select &lt;code>VPN&lt;/code> under the &lt;code>Network&lt;/code> section.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click the &lt;code>Tools&lt;/code> button and click the &lt;code>View Virtual Routes&lt;/code> button&lt;/p>
&lt;p>&lt;img src="network-tools.png" alt="Virtual Network Tools">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>A table will appear with routing information for the node.&lt;/p>
&lt;p>&lt;img src="virtual-route-table.png" alt="Virtual Route Table">&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="analyzing-the-route-table">Analyzing the Route Table&lt;/h2>
&lt;h3 id="route-availability">Route Availability&lt;/h3>
&lt;p>If a route is available, its &lt;code>Active&lt;/code> column will show a green up arrow (&lt;i class="fa-solid fa-arrow-up" style="color: green;">&lt;/i>). If a route is not available, its &lt;code>Active&lt;/code> column will show a red down arrow (&lt;i class="fa-solid fa-arrow-down" style="color: red;">&lt;/i>).&lt;/p>
&lt;h3 id="route-preference">Route Preference&lt;/h3>
&lt;p>Routes will be selected based on the following order:&lt;/p>
&lt;ol>
&lt;li>In overlapping routes, the most specific route wins. For example, 10.20.0.51/32 takes precedence over 10.20.0.0/24.&lt;/li>
&lt;li>If multiple matching routes exist, the route with the lowest metric wins. For example, a metric of 1 takes precedence over a metric of 50.&lt;/li>
&lt;/ol></description></item></channel></rss>