<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>– Node Appliance Deployments</title><link>https://docs.trustgrid.io/tutorials/deployments/</link><description>Recent content in Node Appliance Deployments on</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://docs.trustgrid.io/tutorials/deployments/index.xml" rel="self" type="application/rss+xml"/><item><title>Tutorials: AWS Requirements for HA Wireguard Cluster</title><link>https://docs.trustgrid.io/tutorials/deployments/aws-ha-cluster/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/tutorials/deployments/aws-ha-cluster/</guid><description>
&lt;ol>
&lt;li>Create EC2 Target Group and add both Trustgrid gateways with the target being wireguard server port (Default UDP 51820)&lt;/li>
&lt;/ol>
&lt;p>The health check should be set to http with a path of /status and override traffic port to be port 80.&lt;/p>
&lt;p>Only the active member of the Trustgrid Cluster will respond as healthy to the health check.&lt;/p>
&lt;p>&lt;img src="wg-ha.png" alt="img">&lt;/p>
&lt;p>&lt;img src="health-checks.png" alt="img">&lt;/p>
&lt;ol start="2">
&lt;li>Create NLB (Network Load Balancer) with listener set to configured UDP wireguard server port (Default 51820) and forwarding to the target group created above. The load balancer should be created as internet facing IPV4 and mapped to the Public facing subnets of the Trustgrid gateways.&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="edit-listener.png" alt="img">&lt;/p></description></item><item><title>Tutorials: AWS Requirements for HA ZTNA Gateway Cluster</title><link>https://docs.trustgrid.io/tutorials/deployments/aws-ha-ztna-gateway-cluster/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/tutorials/deployments/aws-ha-ztna-gateway-cluster/</guid><description>
&lt;ol>
&lt;li>Create EC2 target group and add both Trustgrid application gateways with the target being TCP port 80.&lt;/li>
&lt;/ol>
&lt;p>The health check should be for http and the path should be &lt;code>/status&lt;/code>&lt;/p>
&lt;p>Only the active member of the Trustgrid Cluster will respond as healthy to this check.&lt;/p>
&lt;p>&lt;img src="nate-test.png" alt="img">&lt;/p>
&lt;ol start="2">
&lt;li>Create an ALB (Application Load Balancer) with the listener set to HTTPS and forwarding to the target group created above. Under secure listener settings apply the SSL Certificate provided by Trustgrid for the application gateways. &lt;code>ELBSecurityPolicy-2016-08&lt;/code> is recommended as the default security policy by AWS.&lt;/li>
&lt;/ol>
&lt;p>The load balancer should be created as internet facing IPV4 and mapped to the Public facing subnets of the Trustgrid gateways.&lt;/p>
&lt;p>&lt;img src="listener-details.png" alt="img">&lt;/p></description></item><item><title>Tutorials: Configure HA Trustgrid Gateway Cluster in AWS</title><link>https://docs.trustgrid.io/tutorials/deployments/configure-ha-gateway-cluster-in-aws/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/tutorials/deployments/configure-ha-gateway-cluster-in-aws/</guid><description>
&lt;ol>
&lt;li>
&lt;p>Deploy a pair of Trustgrid gateways. Deployment guide includes an example Cloud Formation template that can be used directly or customized for your environment or converted to Terraform if preferred. Gateways can be deployed in the same availability zone or different ones to provide greater redundancy across AWS. &lt;a href="https://docs.trustgrid.io/tutorials/deployments/deploy-aws-ami/">Deploy a Trustgrid Node AMI in AWS&lt;/a>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Under networking &amp;gt; clusters create a cluster using a descriptive and unique name as seen below.
&lt;img src="add-cluster.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select the cluster that was created and add both gateways to it using the actions drop down button as seen below.
&lt;img src="add-node.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Configure the cluster heartbeat on each individual gateway node. This is located under system &amp;gt; cluster. The host should be the gateway interface on which you want to configure the heartbeat. This can be either the WAN facing or LAN facing interface. You can see what IP is configured from the node page under interfaces. The port defaults to TCP 9000 but can be any unused TCP port if desired. Security groups for both gateways will need to allow this communication in both directions. Both gateways send a heartbeat to each other on the configured IP and Port to determine if the other member is healthy. If the secondary is not able to get a response from the primary then it will become the active member of the cluster. Once this has been configured both nodes should show as green and healthy in the cluster as seen below.
&lt;img src="cluster-status.png" alt="img">
&lt;img src="nodes-list.png" alt="img">&lt;/p>
&lt;div class="alert alert-primary" role="alert">
If deploying gateways in different availability zones then LAN interface routes will need to be added to the cluster for both gateway LAN subnets as seen below. This is to ensure the heartbeat communication is routed over the correct interface instead of going out the WAN interface.
&lt;/div>
&lt;p>&lt;img src="interfaces.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Under the cluster &amp;gt; interfaces &amp;gt; eth1 LAN &amp;gt; AWS Route Table Entries add the appropriate CIDR for the edge IP space. This should be the subnet that includes all virtual network IP space configured for edge node sites. For example if you have 100 different edge node sites carved out of 172.16.0.0/16 then you would just add this one CIDR. Once this has been added the route should be created in the routing table that is associated to the gateways LAN interface pointing to the ENI of the active member of the cluster.&lt;/p>
&lt;p>There is an IAM profile that should have been associated to each gateway outlined in the deployment guide providing them permissions to manage the routes defined in the AWS Route Table Entries. When a failover event occurs an API Call is made to update the route to point to the ENI of the active member of the cluster.&lt;/p>
&lt;p>This concludes the cluster configuration specifics for AWS deployment. Appropriate VPN configuration will need to be applied in order for traffic to pass end to end between the gateways and edge node sites.&lt;/p>
&lt;/li>
&lt;/ol></description></item><item><title>Tutorials: Deploy a Trustgrid Node AMI in AWS</title><link>https://docs.trustgrid.io/tutorials/deployments/deploy-aws-ami/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/tutorials/deployments/deploy-aws-ami/</guid><description>
&lt;p>Standing up a Trustgrid node in AWS is easy using an Amazon AMI. Trustgrid nodes in AWS use two network interfaces - a management and data interface. The management interface communicates with Trustgrid Cloud Management systems. The data interface is used to terminate TLS tunnels from Edge Nodes.&lt;/p>
&lt;h2 id="notes">Notes&lt;/h2>
&lt;ul>
&lt;li>The cloudformation template below works with an AMI currently published in US-EAST1. Deploying in other regions requires working with Trustgrid Support&lt;/li>
&lt;li>Logs /var/log/syslog, /var/log/secure, and /var/log/trustgrid/tg-default.log to CloudWatch&lt;/li>
&lt;li>Requires VPC and public subnet&lt;/li>
&lt;li>Does not create security groups or roles - those have to be managed separately (more below)&lt;/li>
&lt;/ul>
&lt;div class="alert alert-primary" role="alert">
&lt;p>If using a burstable performance instance types (T2, T3 and T3a) the following is advised:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Set CPU Credits for all Gateway instances to unlimited to allow CPU to burst in the event there is a spike above the normal threshold. &lt;a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode.html">Unlimited mode for burstable performance instances - Amazon Elastic Compute Cloud&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Configure monitoring of your CPU Credit Balance to alert if your credits are being consumed or you are being charged for additional CPU usage which might warrant resizing your devices. &lt;a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-monitoring-cpu-credits.html">Monitor your CPU credits - Amazon Elastic Compute Cloud&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/div>
&lt;h2 id="prerequisites">Prerequisites&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>VPC with public and private subnets - Management NIC goes in the public subnet, Data NIC goes in the private subnet&lt;/p>
&lt;ul>
&lt;li>Note: If doing a multi-AZ cluster deployment the private subnets need to use the same route table for automated route management to work&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Security group for management NIC that allows the following traffic:&lt;/p>
&lt;ul>
&lt;li>Inbound traffic on designated Trustgrid gateway port (typical TCP 8443) for remote nodes. Access to this port can be secured to only allow access from remote nodes if desired. This is only required if deploying a Trustgrid gateway. If the node is acting as an edge then no inbound access is required.&lt;/li>
&lt;li>Outbound traffic to Trustgrid’s control plane IP (TCP 80/443 &amp;amp; 8443 to 35.171.100.16/28 &amp;amp; 34.223.12.192/28)&lt;/li>
&lt;li>Outbound traffic to AWS API (TCP 443) &lt;a href="https://docs.aws.amazon.com/general/latest/gr/aws-ip-ranges.html">https://docs.aws.amazon.com/general/latest/gr/aws-ip-ranges.html&lt;/a>&lt;/li>
&lt;li>Inbound &amp;amp; Outbound to/from management NIC security group on cluster port (typically TCP port 9000)&lt;/li>
&lt;li>For the initial deployment outbound access for TCP 80/443 should be allowed. Upon successful registration with the Trustgrid Portal this can be removed.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>IAM role for the instance with policies allowing publishing to Cloudwatch logs and changes to the routing table of the data NIC - See attached doc&lt;/p>
&lt;/li>
&lt;li>
&lt;p>All Interfaces on the Trustgrid Gateway should have source / destination check disabled in AWS&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Security group for data NIC - No configuration for now&lt;/p>
&lt;/li>
&lt;li>
&lt;p>An IP in the private subnet that will be used by the data NIC&lt;/p>
&lt;/li>
&lt;li>
&lt;p>An SSH keypair that can be used to SSH to the instance if necessary&lt;/p>
&lt;/li>
&lt;li>
&lt;p>VPC must have unallocated public IP that will be claimed during provisioning&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="process">Process&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>Create a new Node. When complete the Node license will copy to clipboard.&lt;/p>
&lt;ul>
&lt;li>Note: The node will not be visible in the portal until the registration process is complete.&lt;/li>
&lt;li>Download the license to local storage in case the clipboard is cleared. You cannot reissue a license without recreating the node.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Click this link to start the AMI provisioning process. &lt;a href="https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/create/review?templateURL=https://s3.amazonaws.com/tg-dev-public/cf-trustgrid-node-2204.json">https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/create/review?templateURL=https://s3.amazonaws.com/tg-dev-public/cf-trustgrid-node-2204.json&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Fill out the fields in the CloudFormation form&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="instance-configuration">Instance Configuration&lt;/h2>
&lt;tr id="stack-name">
&lt;th>Stack Name&lt;/th>
&lt;td>Unique name to describe this deployment&lt;/td>
&lt;/tr>
&lt;tr id="instance-type">
&lt;th>Instance Type&lt;/th>
&lt;td>Set the instance type of the EC2 instance to deploy (bigger instances cost more)&lt;/td>
&lt;/tr>
&lt;tr id="host-iam-role">
&lt;th>Host IAM Role&lt;/th>
&lt;td>&lt;p>An EC2 associated role that allows creating and writing to CloudWatch logs. Only the role name itself is required.&lt;/p>
&lt;p>The role needs these IAM privileges: &lt;code>logs:CreateLogGroup&lt;/code>, &lt;code>logs:CreateLogStream&lt;/code>, &lt;code>logs:PutLogEvents&lt;/code>, &lt;code>logs:DescribeLogStreams&lt;/code> on resource &lt;code>arn:aws:logs:*:*:*&lt;/code>&lt;/p>
&lt;p>Cloudwatch logs policy&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Version&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;2012-10-17&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Statement&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Effect&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;Allow&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Action&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;logs:CreateLogGroup&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;logs:CreateLogStream&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;logs:PutLogEvents&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Resource&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;*&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>If EC2 Nodes will be clustered (Layer 3) the IAM role needs &lt;code>ec2:DescribeRouteTables&lt;/code> for any resource and &lt;code>ec2:CreateRoute&lt;/code> &amp;amp; &lt;code>ec2:DeleteRoute&lt;/code> on the route table&lt;/p>
&lt;p>Route Table Policy&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Effect&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;Allow&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Action&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;ec2:DescribeRouteTables&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Resource&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;*&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#a40000">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Effect&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;Allow&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Action&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;ec2:CreateRoute&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;ec2:DeleteRoute&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;Resource&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;arn:aws:ec2:us-east-1:079972220921:route-table/rtb-f428d58b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>NOTE&lt;/strong>: Set the Resource field to the ARN of the Routing Table associated with the data NICs of the instance.&lt;/p>
&lt;p>&lt;strong>CloudWatch Note&lt;/strong>: We will create log groups named /trustgrid/var/log/syslog and /trustgrid/var/log/trustgrid/tg-default.log.&lt;/p>
&lt;/td>
&lt;/tr>
&lt;tr id="ssh-keypair">
&lt;th>SSH Keypair&lt;/th>
&lt;td>&lt;p>SSH keypair to SSH to the instance as ubuntu user if necessary&lt;/p>
&lt;p>&lt;strong>NOTE&lt;/strong>: SSH access requires a security group change allowing access. We strongly recommend that SSH is not allowed from anywhere (0.0.0.0/0).&lt;/p>
&lt;/td>
&lt;/tr>
&lt;h2 id="management-configuration">Management Configuration&lt;/h2>
&lt;tr id="security-group">
&lt;th>Security Group&lt;/th>
&lt;td>Needs to allow outbound traffic to other gateways and our public IP range, at a minimum. If it&amp;rsquo;s a gateway node, needs to allow inbound access on desired gateway port.&lt;/td>
&lt;/tr>
&lt;tr id="subnet">
&lt;th>Subnet&lt;/th>
&lt;td>The VPC subnet to put the EC2 instance in. This needs to be a subnet with public IP enables (the instance will automatically claim one; the Auto-Assign Public IP does not need to be enabled)&lt;/td>
&lt;/tr>
&lt;h2 id="data-path-configuration">Data Path Configuration&lt;/h2>
&lt;tr id="security-group">
&lt;th>Security Group&lt;/th>
&lt;td>The security group for the data path - needs to allow outbound communication to other gateways, and inbound communication on its gateway port&lt;/td>
&lt;/tr>
&lt;tr id="subnet">
&lt;th>Subnet&lt;/th>
&lt;td>The VPC subnet to put the data interface in - if it&amp;rsquo;s a cloud-accessible gateway, should be a public subnet, if it&amp;rsquo;s only for internal AWS traffic, can be a private subnet. Will need outbound access either through IGW or NAT GW.&lt;/td>
&lt;/tr>
&lt;tr id="data-ip">
&lt;th>Data IP&lt;/th>
&lt;td>The private IP for the data path - must belong to the subnet&lt;/td>
&lt;/tr>
&lt;h2 id="trustgrid-configuration">Trustgrid Configuration&lt;/h2>
&lt;tr id="security-group">
&lt;th>Security Group&lt;/th>
&lt;td>&lt;p>Copy/paste the license from the portal.&lt;/p>
&lt;p>Note: It is critical that you copy/paste the license correctly.&lt;/p>
&lt;/td>
&lt;/tr>
&lt;div class="alert alert-primary" role="alert">
If you are not a direct Trustgrid customer please work with your vendor to get these licenses generated and sent to you.
&lt;/div>
&lt;h2 id="creating-the-stack">Creating the Stack&lt;/h2>
&lt;ol>
&lt;li>Create the stack. Check the box acknowleding that AWS CloudFormation might create IAM resources. This is required because we create an instance profile for the to-be-run EC2 instance.&lt;/li>
&lt;li>When the node appears in the Portal, activate it.&lt;/li>
&lt;li>In the EC2 console, reboot the node (it will be named trustgrid-node)&lt;/li>
&lt;li>You can now manage the node as you would any other in the Portal UI.&lt;/li>
&lt;/ol></description></item><item><title>Tutorials: Deploy to Azure</title><link>https://docs.trustgrid.io/tutorials/deployments/deploy-azure/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/tutorials/deployments/deploy-azure/</guid><description>
&lt;h2 id="azure-requirements">Azure Requirements&lt;/h2>
&lt;ul>
&lt;li>An Azure subscription. If you don&amp;rsquo;t have one, create a &lt;a href="https://azure.microsoft.com/free/">free account&lt;/a>&lt;/li>
&lt;li>An Azure resource group to deploy the resources into&lt;/li>
&lt;li>An Azure Virtual Network (vNet) with at least two subnets:
&lt;ul>
&lt;li>An &amp;ldquo;outside&amp;rdquo; subnet for the appliance to connect to the Trustgrid control plane and data plane gateways, and accept incoming connections if the Azure Trustgrid appliance will be acting as a &lt;a href="https://docs.trustgrid.io/docs/nodes/gateway/">data plane gateway&lt;/a>&lt;/li>
&lt;li>An &amp;ldquo;inside&amp;rdquo; subnet for communicating with other virtual machines and services within the Azure vNet&lt;/li>
&lt;li>&lt;strong>(For Clustered Appliances)&lt;/strong> An &lt;a href="#azure-route-table">Azure routing table&lt;/a> associated with the &amp;ldquo;inside&amp;rdquo; subnet.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="vm-requirements">VM Requirements&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Requirement&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Disk Size&lt;/td>
&lt;td>At least 30 GB&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Interfaces&lt;/td>
&lt;td>&lt;ul>&lt;li>1 Public with a Public IP address&lt;/li>&lt;li>1 Private&lt;/li>&lt;ul>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CPU &amp;amp; RAM&lt;/td>
&lt;td>See &lt;a href="https://docs.trustgrid.io/tutorials/deployments/deploy-azure/#instance-size">Instance Type below&lt;/a> for recommendations&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="instance-size">Instance Size&lt;/h3>
&lt;p>Trustgrid has validated using the &lt;a href="https://learn.microsoft.com/en-us/azure/virtual-machines/sizes-b-series-burstable">B-series burstable - Azure Virtual Machines&lt;/a> instance type.&lt;/p>
&lt;p>VPN throughput is tied to CPU the recommended size depends on roles, expected throughput.&lt;/p>
&lt;ul>
&lt;li>For Gateway nodes expecting up to ~200Mbps throughput, Trustgrid recommends the Standard_B4ms or larger&lt;/li>
&lt;li>For Edge nodes expecting less than 100Mbps throughput, Trustgrid recommends the Standard_B2s or Standard_B2ms or larger&lt;/li>
&lt;/ul>
&lt;h3 id="interfaces">Interfaces&lt;/h3>
&lt;p>One WAN interface with a public IP and one LAN interface on a private subnet. The nodes will need to be able to route to all required hosts/applications that need to communicate across the Trustgrid virtual network.&lt;/p>
&lt;p>The LAN interface needs to have &lt;strong>IP Forwarding Enabled&lt;/strong> in order to forward the traffic across the tunnel.&lt;/p>
&lt;p>&lt;img src="azure-ip-config.png" alt="IP Forwarding">&lt;/p>
&lt;p>See &lt;a href="https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview">Azure virtual network traffic routing&lt;/a>.&lt;/p>
&lt;h3 id="supported-regions">Supported Regions&lt;/h3>
&lt;p>The Trustgrid official community image, &lt;code>trustgrid-node-2204-prod&lt;/code>, in the public gallery &lt;code>trustgrid-45680719-9aa7-43b9-a376-dc03bcfdb0ac&lt;/code> is currently published in the following region. If you need to deploy in another region please contact Trustgrid support. If you are not a direct customer of Trustgrid, please check with your vendor that is utilizing Trustgrid to have them contact support.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Region Display Name&lt;/th>
&lt;th>Region Name&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>East US&lt;/td>
&lt;td>eastus&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Central US&lt;/td>
&lt;td>centralus&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>North Central US&lt;/td>
&lt;td>northcentralus&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>South Central US&lt;/td>
&lt;td>southcentralus&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>West US&lt;/td>
&lt;td>westus&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="network-access">Network Access&lt;/h3>
&lt;p>For gateways:&lt;/p>
&lt;ul>
&lt;li>Outbound internet access to the &lt;a href="https://docs.trustgrid.io/help-center/kb/site-requirements/">Trustgrid control plane networks&lt;/a> and ability to resolve public DNS names.&lt;/li>
&lt;li>Inbound access required is the TCP port defined for the Trustgrid gateway service to listen on. Edge nodes will connect to the gateways public IP and port defined. The default port used is 8443.&lt;/li>
&lt;/ul>
&lt;p>For edge nodes:&lt;/p>
&lt;ul>
&lt;li>Outbound internet access to the &lt;a href="https://docs.trustgrid.io/help-center/kb/site-requirements/">Trustgrid control plane networks&lt;/a>, outbound access to the IP and ports of the Trustgrid gateways, and ability to resolve public DNS names.&lt;/li>
&lt;li>No inbound access is required on the public interface.&lt;/li>
&lt;/ul>
&lt;p>For all clustered nodes:&lt;/p>
&lt;ul>
&lt;li>The cluster heartbeat runs on the LAN/inside interface on TCP Port 9000. This port will need to be open between both Trustgrid Gateways for failover to work correctly.&lt;/li>
&lt;/ul>
&lt;h3 id="other-vm-requirements">Other VM Requirements&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://learn.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/qs-configure-portal-windows-vm">System-assigned Managed Identity&lt;/a> needs to be enabled for both VMs in the cluster.
&lt;figure class="centered-image">
&lt;img src="system-managed-identity.png" alt="System-assigned Managed Identity" style="display: block; margin-left: auto; margin-right: auto; width: 80%;">
&lt;/figure>
&lt;/li>
&lt;li>&lt;a href="https://learn.microsoft.com/en-us/azure/virtual-machines/boot-diagnostics">Boot Diagnostics&lt;/a> needs to be enabled to allow access via the Serial Console&lt;/li>
&lt;/ul>
&lt;h2 id="requirements-for-ha-failover">Requirements for HA Failover&lt;/h2>
&lt;h3 id="azure-routing-table">Azure Routing Table&lt;/h3>
&lt;p>An Azure routing table resource needs to be associated with the LAN interface&amp;rsquo;s subnet.&lt;/p>
&lt;h4 id="view-lan-subnet-routing-table">View LAN Subnet Routing Table&lt;/h4>
&lt;ol>
&lt;li>In the Azure Portal search for Virtual Networks and select the service&lt;/li>
&lt;li>From the list of Virtual Networks select your target Virtual Network&lt;/li>
&lt;li>From the navigation panel select Subnets&lt;/li>
&lt;li>Select your inside/private subnet that is attached to the LAN interface of your Trustgrid VMs&lt;/li>
&lt;li>There should be a route table
&lt;figure class="centered-image">
&lt;img src="azure-route-table.png" alt="Example subnet showing assigned Route Table" style="display: block; margin-left: auto; margin-right: auto; width: 60%;">
&lt;/figure>
&lt;/li>
&lt;/ol>
&lt;h4 id="create-route-table-for-lan-subnet">Create Route Table for LAN Subnet&lt;/h4>
&lt;ol>
&lt;li>If there is no Route Table associated with your LAN/inside/private subnet you will need to add it.&lt;/li>
&lt;li>In the Azure portal search for Route Tables and select the service&lt;/li>
&lt;li>Click the +Create button&lt;/li>
&lt;li>Select the Resource Group that contains your Virtual Network and VMs&lt;/li>
&lt;li>Select the Region that your VMs are deployed in&lt;/li>
&lt;li>Give the Route Table a name consistent with your naming conventions&lt;/li>
&lt;li>(Optional) change the Propagate Gateway routes option.
&lt;figure class="centered-image">
&lt;img src="propagate-routes.png" alt="Propagate Routes Option" style="display: block; margin-left: auto; margin-right: auto; width: 70%;">
&lt;/figure>
&lt;/li>
&lt;li>Click Review + Create, review then click Review + Create again&lt;/li>
&lt;li>Repeat the above steps to “View LAN Subnet Routing Table” and change the route table from None to the newly created Route Table.&lt;/li>
&lt;li>Save the change&lt;/li>
&lt;/ol>
&lt;h3 id="permissions-required-for-cluster-route-failover">Permissions Required for Cluster Route Failover&lt;/h3>
&lt;p>Copy this sample json file for use in creating a custom role with the required permissions. See process below.&lt;/p>
&lt;blockquote>
&lt;p>The assignableScopes section will need to be modified to represent the resource information of the target Azure account.&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;properties&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;roleName&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;tg-route-table&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;description&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;manage azure route table&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;assignableScopes&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;permissions&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;actions&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/networkWatchers/nextHop/action&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/networkInterfaces/effectiveRouteTable/action&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/routeTables/routes/delete&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/routeTables/routes/write&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/routeTables/routes/read&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/routeTables/join/action&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/routeTables/delete&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/routeTables/write&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/routeTables/read&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/networkInterfaces/read&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Network/virtualNetworks/read&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;Microsoft.Compute/virtualMachines/read&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;notActions&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;dataActions&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;notDataActions&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;ol>
&lt;li>
&lt;ol>
&lt;li>A custom role needs to be created in the Azure subscription that allows the Trustgrid nodes to update the route table when failover occurs&lt;/li>
&lt;li>Create the custom role
&lt;ol>
&lt;li>
&lt;p>In the Azure portal search for “Subscriptions” and select the Subscriptions service&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select the subscription that contains the Trustgrid VMs&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select “Access control (IAM),” then click “+Add”, then “Add custom role”&lt;/p>
&lt;p>&lt;img src="add-custom-role.png" alt="Add Custom Role">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Save the JSON above to a file named &lt;code>azure-custom-role-sample.json&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select “Start from JSON” and from the file selector, select the downloaded json file.&lt;/p>
&lt;p>&lt;img src="create-custom-role.png" alt="Create Custom Role">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Optionally, update the role name to meet your internal naming conventions.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click &lt;code>Next&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>On the Permissions page you will see the permissions that will be granted. Click &lt;code>Next&lt;/code> again.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>On the Assignable Scopes page click +Add Assignable Scope&lt;/p>
&lt;ol>
&lt;li>
&lt;p>From the Type select Resource Group&lt;/p>
&lt;/li>
&lt;li>
&lt;p>From the Subscription, select the subscription your VMs and virtual networks are in.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>From the Select pane on the right search for and select the Resource Group containing you VM’s&lt;/p>
&lt;p>&lt;img src="select-group.png" alt="Resource Group">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click &lt;code>Select&lt;/code> and then &lt;code>Next&lt;/code>.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>On the JSON page, click the &lt;code>Next&lt;/code> button.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click Review + Create, then click Create.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>Assign the custom role to your Trustgrid VM’s system-assigned&lt;/p>
&lt;ol>
&lt;li>
&lt;p>In the Azure portal search for Resource Groups and select the service&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select your target Resource Group&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select the Access Control (IAM) panel, then click +Add, then “Add role assignment”&lt;/p>
&lt;p>&lt;img src="add-role.png" alt="Add Role Assignment">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Search for and select the desired role and click Next&lt;/p>
&lt;p>&lt;img src="role-list.png" alt="Find Role">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Under “Assign access to” select “Managed Identity” then click +Select members&lt;/p>
&lt;p>&lt;img src="select-members.png" alt="Select Members">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>From the Managed Identity dropdown select Virtual Machine&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select the identity for your first Trustgrid VM&lt;/p>
&lt;p>&lt;img src="subscriptions.png" alt="Subscription">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click select.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click +Select members again and repeat with your second Trustgrid VM&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click “Review + Assign” then “Review + Assign” a second time&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>These permissions can take some time to go into effect.&lt;/p>
&lt;/blockquote>
&lt;h2 id="deployment-process">Deployment Process&lt;/h2>
&lt;p>One of more Virtual Machines will need to be deployed into the target Azure subscription to act as the Trustgrid nodes using the official community image. Then the &lt;a href="https://docs.trustgrid.io/tutorials/local-console-utility/remote-registration/">remote registration process&lt;/a> can be used to activate the nodes in the Trustgrid portal.&lt;/p>
&lt;h3 id="participants">Participants&lt;/h3>
&lt;ul>
&lt;li>Site Tech - User(s) with permissions and skills to deploy new instances in Azure, create the required Managed System Identity shown above, and make changes in Azure to allow the required network connectivity&lt;/li>
&lt;li>Trustgrid User - User with permissions to &lt;a href="https://docs.trustgrid.io/tutorials/local-console-utility/remote-registration/#portal-activation-process">Activate nodes&lt;/a> in the Trustgrid portal (or API)&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>If the Site Tech is not part of the organization that is a Trustgrid&amp;rsquo;s direct customer, Trustgrid&amp;rsquo;s professional service team will need documented approval from that customer before proceeding with assisting in the deployment.&lt;/p>
&lt;/blockquote>
&lt;h3 id="high-level-process">High-Level Process&lt;/h3>
&lt;ol>
&lt;li>The Site Tech should be able to complete the following steps independently:
&lt;ol>
&lt;li>Build out prerequisite resources including Resource Groups, vNets, subnets and routing tables in Azure&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>For single node deployments:
&lt;ol>
&lt;li>Create VM Instances based of the official Trustgrid community image&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>For clustered deployments:
&lt;ol>
&lt;li>Create a &lt;a href="#azure-routing-table">routing table for the in LAN interface subnet&lt;/a> if it does not already exist&lt;/li>
&lt;li>Create two VM Instances based of the official Trustgrid community image&lt;/li>
&lt;li>Create the Azure IAM role as defined above&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>Use the Azure VM Serial Console to start the registration process, this code then needs to be communicated securely to the Trustgrid User.&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Trustgrid Tech -
&lt;ol>
&lt;li>Activate the device with the target organization&lt;/li>
&lt;li>Confirm healthy functionality and connectivity to the required gateways&lt;/li>
&lt;li>Configure the nodes as needed (e.g. clustering, VPN, L4proxy)&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;h3 id="deployment-methods">Deployment Methods&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://docs.trustgrid.io/tutorials/deployments/deploy-azure/">Deploy via Azure command line tool&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>&lt;em>Documentation Coming Soon for&amp;hellip;&lt;/em>&lt;/p>
&lt;ul>
&lt;li>Deploy via the Azure Portal&lt;/li>
&lt;li>Deploy via Azure Bicep modules&lt;/li>
&lt;/ul></description></item><item><title>Tutorials: Deploy to vSphere</title><link>https://docs.trustgrid.io/tutorials/deployments/deploy-vsphere/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/tutorials/deployments/deploy-vsphere/</guid><description>
&lt;h2 id="requirements">Requirements&lt;/h2>
&lt;h3 id="hardware-resources">Hardware Resources&lt;/h3>
&lt;ul>
&lt;li>4 vCPU&lt;/li>
&lt;li>4 GB RAM&lt;/li>
&lt;li>30 GB disk space&lt;/li>
&lt;/ul>
&lt;h3 id="software-requirements">Software Requirements&lt;/h3>
&lt;ul>
&lt;li>vSphere 6.7 or newer (with VMWare support)&lt;/li>
&lt;/ul>
&lt;h2 id="configuration-best-practices">Configuration Best Practices&lt;/h2>
&lt;h3 id="backups">Backups&lt;/h3>
&lt;p>Trustgrid recommends against backing up virtualized Nodes. Backups that utilize VMware&amp;rsquo;s Data Protection API will initiate a VM Snapshot that will pause all traffic through the VM for a short period of time. This can cause issues such as master failover in a cluster and disruption of existing network flows.&lt;/p>
&lt;p>In place of backups Trustgrid recommends deploying clustered nodes on different ESX hosts if possible. Nodes can be redeployed and rapidly configured as the configuration is stored in our cloud management system.&lt;/p>
&lt;h3 id="dynamic-resource-scheduling-drs-and-storage-drs">Dynamic Resource Scheduling (DRS) and Storage DRS&lt;/h3>
&lt;h4 id="automation-level">Automation Level&lt;/h4>
&lt;p>Trustgrid recommends setting the DRS level for a VM to either Partially Automated or Disabled. Even the temporary loss of network connectivity during vMotion migrations can disrupt some network flows.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.vmware.com/en/VMware-vSphere/6.5/com.vmware.vsphere.resmgmt.doc/GUID-C21C0609-923B-46FB-920C-887F00DBCAB9.html">Set a Custom Automation Level for a Virtual Machine&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.resmgmt.doc/GUID-B560341B-B377-4FA7-BF3B-98A4788AAE3A.html">Change Storage DRS Automation Level for a Virtual Machine&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="recommended-anti-affinity">(Recommended) Anti-Affinity&lt;/h4>
&lt;p>If you have Trustgrid nodes clustered within a vSphere Cluster with DRS enabled you should create an anti-affinity rule. This rule should keep the nodes running on independent hosts for additional hardware redundancy.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.resmgmt.doc/GUID-FBE46165-065C-48C2-B775-7ADA87FF9A20.html#GUID-FBE46165-065C-48C2-B775-7ADA87FF9A20">Create VM Anti-Affinity Rules&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="deployment-process">Deployment Process&lt;/h2>
&lt;p>The Trustgrid gateway node can be deployed in a vSphere environment (v6.7 and higher) using a custom VM template provided by Trustgrid. Follow the instructions below to deploy the OVF template in your environment.&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Download &amp;amp; Extract the customized VM template from the link sent to you by Trustgrid&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Open &amp;amp; log in to your vSphere web client&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Navigate to Host &amp;amp; Clusters&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Right click on vSphere ESX host in the Navigator pane and select Deploy OVF Template&lt;/p>
&lt;p>&lt;img src="deploy-ovf-template.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select Local File and then click Browse&lt;/p>
&lt;p>&lt;img src="browse-local-file.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select all of the files included in the zip file and click open, then click Next&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Confirm the name and desired location for your VM and click Next&lt;/p>
&lt;p>&lt;img src="name-vm.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select a resource to place your VM on and click Next&lt;/p>
&lt;p>&lt;img src="select-resource.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click Next on the Review Details pane&lt;/p>
&lt;p>&lt;img src="review-details.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select your preferred storage options and click Next&lt;/p>
&lt;p>&lt;img src="select-storage.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Select the proper networks for your network interfaces.&lt;/p>
&lt;p>&lt;img src="select-networks.png" alt="img">&lt;/p>
&lt;ul>
&lt;li>The destination network for the first network interface will be the network designated for the node’s management interface. If you opted for a single interface configuration, you will only need this interface connected.&lt;/li>
&lt;li>The destination network for the second network interface will be the network designated for the node’s data interface. If you opted for a single interface configuration you will still need to provide a port group for this to complete the deployment but it can be disconnected after deployment&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Verify the configuration data and click Finish to deploy the VM&lt;/p>
&lt;p>&lt;img src="complete.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Once your VM Template has finished deployment, power on the VM&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>Deployment of your Trustgrid gateway node VM is now complete. If configuring this Node as a gateway, the next step will be to allow inbound TCP port 8443 to your gateway VM to allow remote nodes to connect back to it.&lt;/p></description></item><item><title>Tutorials: On a Stick Configuration</title><link>https://docs.trustgrid.io/tutorials/deployments/ros-config/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.trustgrid.io/tutorials/deployments/ros-config/</guid><description>
&lt;div class="pageinfo pageinfo-primary">
&lt;p>Edge nodes can be configured in an &amp;ldquo;on a stick&amp;rdquo; configuration, in which only a single NIC is used for each node. Operating in this mode is supported only when using Layer 3 or Layer 4 configuration where hosts behind gateway nodes need access to data behind edge nodes.&lt;/p>
&lt;/div>
&lt;p>In this configuration, the source IP of traffic from the edge node depends on whether Layer 3 or Layer 4 is being used, as illustrated below.&lt;/p>
&lt;h3 id="layer-3">Layer 3&lt;/h3>
&lt;p>Traffic will originate only from the current active node from the IP address(es) specified in outside NAT rules in the edge node&amp;rsquo;s config.&lt;/p>
&lt;p>&lt;img src="l3-stick.png" alt="img">&lt;/p>
&lt;h3 id="layer-3---routed-single-edge-node">Layer 3 - routed single edge node&lt;/h3>
&lt;p>Trustgrid node(s) used as the next hop in a route for the Trustgrid virtual network. Traffic at the edge will originate from the node&amp;rsquo;s IP address.&lt;/p>
&lt;p>&lt;img src="l3-routed.png" alt="img">&lt;/p>
&lt;h3 id="layer-4">Layer 4&lt;/h3>
&lt;p>Traffic will originate from either edge node with round-robin load-balancing with the source IP address being the IP address of whichever node the traffic originates from.&lt;/p>
&lt;p>&lt;img src="l4-stick.png" alt="img">&lt;/p></description></item></channel></rss>